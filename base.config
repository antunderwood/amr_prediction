params.output_dir = ".default_hidden"
params.pipeline_info = "${params.output_dir}/pipeline_info"
timeline {
  enabled = true
  file = "${params.pipeline_info}/execution_timeline.html"
}
report {
  enabled = true
  file = "${params.pipeline_info}/execution_report.html"
}
dag {
  enabled = true
  file = "${params.pipeline_info}/pipeline_dag.png"
}
trace {
  enabled = true
  file = "${params.pipeline_info}/pipeline_stats.txt"
  fields = "task_id,\
  hash,\
  process,\
  tag,\
  status,\
  exit,\
  start,\
  container,\
  cpus,\
  time,\
  disk,\
  memory,\
  duration,\
  realtime,\
  queue,\
  %cpu,\
  %mem,\
  rss,\
  vmem,\
  rchar,\
  wchar"
}
process {
  cpus = 1
  memory = '1G'
  errorStrategy = { task.attempt <= 2 ? "retry" : "finish" }
  maxRetries = 2
  withName:'polish_reads:estimate_genome_size' {
    container = 'bioinformant/ghru-read-polishing:1.0'
  }
  withName:'polish_reads:trim_reads' {
    container = 'bioinformant/ghru-read-polishing:1.0'
  }
  withName:'polish_reads:correct_reads' {
    container = 'bioinformant/ghru-read-polishing:1.0'
  }
  withName:'polish_reads:downsample_reads' {
    container = 'bioinformant/ghru-read-polishing:1.0'
  }
  withName:'ariba:run_ariba' {
    container = 'bioinformant/ghru-ariba:1.0'
  }
  withName:'ariba:ariba_summary' {
    container = 'bioinformant/ghru-ariba:1.0'
  }
}
